<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI ì£¼ì‹ ë¶„ì„ ì‹œë®¬ë ˆì´í„°</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: 'Pretendard', sans-serif; background: #f4f7f9; margin: 20px; }
        .container { max-width: 1000px; margin: auto; background: white; padding: 20px; border-radius: 12px; shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .controls { display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; }
        input, button { padding: 10px; border-radius: 6px; border: 1px solid #ccc; }
        button { background: #007bff; color: white; cursor: pointer; border: none; }
        #chart-container { position: relative; height: 50vh; width: 100%; }
        .analysis-box { margin-top: 20px; padding: 15px; border-left: 5px solid #007bff; background: #eef6ff; }
        .trade-log { margin-top: 10px; font-size: 0.9em; line-height: 1.6; }
        .buy { color: red; font-weight: bold; }
        .sell { color: blue; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <h2>ğŸ“Š ì£¼ì‹ ë¶„ì„ & ìë™ ë§¤ë§¤ ì‹œë®¬ë ˆì´ì…˜</h2>
    
    <div class="controls">
        <input type="text" id="stockCode" placeholder="ì¢…ëª©ì½”ë“œ (ì˜ˆ: 005930)" value="005930">
        <input type="number" id="period" placeholder="ë¶„ì„ ê¸°ê°„(ì¼)" value="30">
        <button onclick="analyzeStock()">ë¶„ì„ ì‹¤í–‰</button>
    </div>

    <div id="chart-container">
        <canvas id="stockChart"></canvas>
    </div>

    <div id="analysisResult" class="analysis-box" style="display:none;">
        <h3>ğŸ§ ë¶„ì„ ê²°ê³¼ ë° ë§¤ë§¤ ì „ëµ</h3>
        <p id="summaryText"></p>
        <hr>
        <div id="tradeLog" class="trade-log"></div>
    </div>
</div>

<script>
let myChart = null;

function analyzeStock() {
    const code = document.getElementById('stockCode').value;
    const period = parseInt(document.getElementById('period').value);
    
    // 1. ê°€ìƒ ë°ì´í„° ìƒì„± (ì‹¤ì œ í™˜ê²½ì—ì„œëŠ” API í˜¸ì¶œ í•„ìš”)
    const data = generateMockData(period);
    
    // 2. ìƒí•œê°€/í•˜í•œê°€ ë° ì§€ì§€/ì €í•­ì„  ê³„ì‚°
    const highPrice = Math.max(...data.prices);
    const lowPrice = Math.min(...data.prices);
    
    // 3. ì°¨íŠ¸ ê·¸ë¦¬ê¸°
    renderChart(data, highPrice, lowPrice);
    
    // 4. ë§¤ë§¤ ì‹œë®¬ë ˆì´ì…˜ ë° ì„¤ëª… ìƒì„±
    generateAnalysis(data, highPrice, lowPrice);
}

function generateMockData(days) {
    let prices = [];
    let labels = [];
    let basePrice = 70000;
    
    for (let i = 0; i < days; i++) {
        basePrice += (Math.random() - 0.5) * 2000;
        prices.push(Math.floor(basePrice));
        labels.push(`${i+1}ì¼ì°¨`);
    }
    return { prices, labels };
}

function renderChart(data, high, low) {
    const ctx = document.getElementById('stockChart').getContext('2d');
    
    if (myChart) myChart.destroy();
    
    myChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: data.labels,
            datasets: [{
                label: 'ì£¼ê°€',
                data: data.prices,
                borderColor: '#333',
                borderWidth: 2,
                fill: false,
                tension: 0.1
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                autocolors: false,
                annotation: { // ìˆ˜í‰ì„  ì¶”ê°€ ë¡œì§ (ê°„ì†Œí™”)
                }
            }
        }
    });
}

function generateAnalysis(data, high, low) {
    const resultDiv = document.getElementById('analysisResult');
    const summary = document.getElementById('summaryText');
    const log = document.getElementById('tradeLog');
    
    resultDiv.style.display = 'block';
    
    // ë¶„ì„ ì„¤ëª…
    summary.innerHTML = `í˜„ì¬ ë¶„ì„ ê¸°ê°„ ë‚´ <b>ìµœê³ ê°€(ì €í•­ì„ )ëŠ” ${high.toLocaleString()}ì›</b>ì´ë©°, 
    <b>ìµœì €ê°€(ì§€ì§€ì„ )ëŠ” ${low.toLocaleString()}ì›</b>ì…ë‹ˆë‹¤. <br>
    í˜„ì¬ ì£¼ê°€ëŠ” ì „ë°˜ì ìœ¼ë¡œ ${data.prices[0] < data.prices[data.prices.length-1] ? 'ìƒìŠ¹' : 'í•˜ë½'} ì¶”ì„¸ì— ìˆìŠµë‹ˆë‹¤.`;

    // ë§¤ë§¤ ì‹œë®¬ë ˆì´ì…˜ (ë‹¨ìˆœ ê³¨ë“ í¬ë¡œìŠ¤/ë°ë“œí¬ë¡œìŠ¤ ê°œë… ì ìš©)
    let logHtml = "<b>[ë§¤ë§¤ ì‹œë®¬ë ˆì´ì…˜ ë¦¬í¬íŠ¸]</b><br>";
    let holding = false;
    
    for(let i = 1; i < data.prices.length; i++) {
        // ê°„ë‹¨í•œ ë¡œì§: ì €ì  ëŒ€ë¹„ 2% ë°˜ë“±ì‹œ ë§¤ìˆ˜, ê³ ì  ëŒ€ë¹„ 2% í•˜ë½ì‹œ ë§¤ë„
        if(!holding && data.prices[i] < low * 1.05) {
            logHtml += `<span class="buy">â— ${i+1}ì¼ì°¨ ë§¤ìˆ˜:</span> ${data.prices[i].toLocaleString()}ì› (ë°”ë‹¥ê¶Œ ì§„ì…)<br>`;
            holding = true;
        } else if(holding && data.prices[i] > high * 0.95) {
            logHtml += `<span class="sell">â—‹ ${i+1}ì¼ì°¨ ë§¤ë„:</span> ${data.prices[i].toLocaleString()}ì› (ëª©í‘œê°€ ë„ë‹¬ ìˆ˜ìµì‹¤í˜„)<br>`;
            holding = false;
        }
    }
    log.innerHTML = logHtml;
}
</script>

</body>
</html>